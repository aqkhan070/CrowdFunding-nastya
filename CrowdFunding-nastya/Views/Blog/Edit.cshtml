@model CrowdFunding_nastya.Models.tblBlog

@{
    ViewBag.Title = "Edit";
    Layout = "~/Views/Shared/_Admin.cshtml";
}


@{
    ViewBag.Title = "Edit";
    Layout = "~/Views/Shared/_Admin.cshtml";
}

<!-- start page title -->
<div class="row">
    <div class="col-12">
        <div class="page-title-box d-sm-flex align-items-center justify-content-between">
            <h4 class="mb-sm-0">Update Blog</h4>

            <div class="page-title-right">
                <ol class="breadcrumb m-0">
                    <li class="breadcrumb-item"><a href="javascript: void(0);">Blogs</a></li>
                    <li class="breadcrumb-item active">Update Blog</li>
                </ol>
            </div>

        </div>
    </div>
</div>
<!-- end page title -->

@using (Html.BeginForm("Edit", "Blog", FormMethod.Post, new { enctype = "multipart/form-data", id = "blogForm" }))
{
    @Html.ValidationSummary(true)

    <div class="row">
        <div class="col-lg-8">
            <div class="card">
                <div class="card-body">
                    @Html.HiddenFor(model => model.BlogId)
                    <div class="mb-3">
                        <label class="form-label" for="project-title-input">Blog Title</label>
                        @Html.EditorFor(model => model.BlogTitle, new { htmlAttributes = new { @class = "form-control", placeholder = "Enter project title" } })
                    </div>

                    <div class="mb-3">
                        <label class="form-label" for="project-thumbnail-img">Thumbnail Image</label>
                        <input class="form-control" name="BlogThumbnailImage" id="project-thumbnail-img" type="file" accept="image/png, image/gif, image/jpeg">
                        <img src="@Model.ThumbnailImage" width="50" height="50" class="mt-2" style="border-radius: 50%;"/>
                    </div>

                    <div class="mb-3">
                        <label class="form-label">Blog Description</label>
                        <div id="ckeditor-classic">
                            @Html.TextAreaFor(model => model.BlogDescription, new { htmlAttributes = new { @id = "BlogDescription" } })
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-lg-4">
                            <div class="mb-3 mb-lg-0">
                                <label for="choices-priority-input" class="form-label">Priority</label>
                                @*@Html.EditorFor(model => model.tblBlogPriority.Priority)*@
                                <select id="PriorityId" class="form-control" name="PriorityId" required>
                                    <option value="" @(Model == null || Model.PriorityId == null ? "selected" : "")>---Select Priority---</option>
                                    @foreach (var list in ViewBag.PriorityList as SelectList)
                                    {
                                        <option value="@list.Value" @(Model != null && list.Value == Model.PriorityId.ToString() ? "selected" : "")>@list.Text</option>
                                    }
                                </select>


                            </div>
                        </div>
                        <div class="col-lg-4">
                            <div class="mb-3 mb-lg-0">
                                <label for="choices-status-input" class="form-label">Status</label>
                                @Html.DropDownListFor(model => model.IsActive, new List<SelectListItem>
                                {
                                    new SelectListItem { Text = "---Select Status---", Value = "", Selected = true },
                                    new SelectListItem { Text = "Active", Value = "true"},
                                    new SelectListItem { Text = "In-Active", Value = "false"}
                                }, new { @class = "form-select", id = "choices-status-input" })
                            </div>
                        </div>
                        <div class="col-lg-4">
                            <div>
                                <label for="datepicker-deadline-input" class="form-label">Publish Date</label>
                                @Html.EditorFor(model => model.PublishDate, new { htmlAttributes = new { @class = "form-control", @type = "datetime", @id = "datepicker-deadline-input", @disabled = "disabled" } })
                            </div>
                        </div>
                    </div>
                </div>
                <!-- end card body -->
            </div>
            <!-- end card -->

            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">Attached files</h5>
                </div>
                <div class="card-body">
                    <div>
                        <p class="text-muted">Add Attached files here.</p>

                        <input name="BlogAttachedFiles" type="file" multiple="multiple">
                        <div class="dropzone">
                            <div class="fallback">
                            </div>
                            <div class="dz-message needsclick">
                                <div class="mb-3">
                                    <i class="display-4 text-muted ri-upload-cloud-2-fill"></i>
                                </div>

                                <h5>Drop files here or click to upload.</h5>
                            </div>
                        </div>

                        <ul class="list-unstyled mb-0" id="dropzone-preview">
                            <li class="mt-2" id="dropzone-preview-list">
                                <!-- This is used as the file preview template -->
                                <div class="border rounded">
                                    <div class="d-flex p-2">
                                        <div class="flex-shrink-0 me-3">
                                            <div class="avatar-sm bg-light rounded">
                                                <img src="#" alt="Project-Image" data-dz-thumbnail class="img-fluid rounded d-block" />
                                            </div>
                                        </div>
                                        <div class="flex-grow-1">
                                            <div class="pt-1">
                                                <h5 class="fs-14 mb-1" data-dz-name>&nbsp;</h5>
                                                <p class="fs-13 text-muted mb-0" data-dz-size></p>
                                                <strong class="error text-danger" data-dz-errormessage></strong>
                                            </div>
                                        </div>
                                        <div class="flex-shrink-0 ms-3">
                                            <button data-dz-remove class="btn btn-sm btn-danger">Delete</button>
                                        </div>
                                    </div>
                                </div>
                            </li>
                        </ul>
                        @foreach (var attachment in Model.tblBlogAttachedFiles)
                        {
                            <img src="@attachment.AttachedFiles" height="50" width="50" class="my-2" loading="lazy" style="border-radius: 50%;"/>
                        }
                        <!-- end dropzon-preview -->
                    </div>
                </div>
            </div>
            <!-- end card -->
            <div class="text-end mb-4">
                <button type="submit" class="btn btn-danger w-sm">Delete</button>
                <button type="button" class="btn btn-secondary w-sm" onclick="goBack()">Cancel</button>
                <button type="submit" class="btn btn-success w-sm" onclick="GetData()">Update</button>
            </div>
        </div>
        <!-- end col -->
        <div class="col-lg-4">
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">Category</h5>
                </div>
                <div class="card-body">
                    <div class="mb-3">
                        <label for="choices-categories-input" class="form-label">Categories</label>
                        @*@Html.EditorFor(model => model.tblBlogCategory.CategoryName, new { @class = "form-select", data_choices = "", data_choices_search_false = "", id = "choices-categories-input" })*@
                        <select id="CategoryId" class="form-control" name="CategoryId" required>
                            <option value="" @(Model == null || Model.CategoryId == null ? "selected" : "")>---Select Category---</option>
                            @foreach (var list in ViewBag.CategoryList as SelectList)
                            {
                                <option value="@list.Value" @(Model != null && list.Value == Model.CategoryId.ToString() ? "selected" : "")>@list.Text</option>
                            }
                        </select>
                    </div>


                </div>
                <!-- end card body -->
            </div>
            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">Type</h5>
                </div>
                <div class="card-body">
                    <div>
                        <label for="choices-privacy-status-input" class="form-label">Blog Type</label>
                        @*@Html.EditorFor(model => model.tblBlogType.BlogTypeName, new { @class = "form-select", data_choices = "", data_choices_search_false = "", id = "choices-privacy-status-input" })*@
                        <select id="CategoryId" class="form-control" name="CategoryId" required>
                            <option value="" @(Model == null || Model.BlogTypeId == null ? "selected" : "")>---Select Category---</option>
                            @foreach (var list in ViewBag.BlogTypeList as SelectList)
                            {
                                <option value="@list.Value" @(Model != null && list.Value == Model.BlogTypeId.ToString() ? "selected" : "")>@list.Text</option>
                            }
                        </select>
                    </div>
                </div>
                <!-- end card body -->
            </div>
            <!-- end card -->
            <!-- end card -->
            <!-- end card -->
        </div>
        <!-- end col -->
    </div>
}
<!-- end row -->
<script src="~/assets/admin/js/jquery-3.2.1.min.js"></script>
<script>
    function goBack() {
        window.history.back();
    }

    function GetData() {
        let html = $(".ck-editor__editable").html();

        $("#BlogDescription").html(html);
    }

    $(document).ready(function () {

        $(".ul li a").removeClass("active");
        $('#blogs').addClass('active');
        $('#sidebarblog').addClass('show');
        $('#addblog').addClass('active');
    });

</script>